<head>
	<title>Horizontal CFB Scoreboard by Solrac8080</title>
	<link rel="icon" type="img/png" href="https://github.com/ionic-team/ionicons/raw/master/png/512/ios7-americanfootball.png">
	
	<link rel="stylesheet" href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js" type="text/javascript"></script>
	<link href="https://fonts.googleapis.com/css?family=Roboto:700" rel="stylesheet">
	
	<style>
	::-webkit-scrollbar { 
    display: none; 
	}
	body{
		background-color: #208040;
		color: white;
		font-family: 'Roboto', sans-serif;
		font-size: 12px;
		font-weight: bold;
	}
	p{
		margin-bottom: 12px;
		margin-top: 2px;
	}
	.floatingbox {
		border-radius: 5px;
		background-color: #104020;
		float: left;
		width:182px;
		height:56px;
		margin:2px;
		border:2px solid grey;
	}
	.split1 {
		float: left;
		width:140px;
		height:100%;
		margin-left:2px;
	}
	.split2 {
		float: right;
		width:38px;
		height:100%;
		text-align: center;
		margin-right:2px
	}

	</style>
	<script>
		var leng=0;
		var jsondata=[]
		
		function makedata(json) {
			var games=[];
			for(var i=0;i<json.scoreboard.length;i++){
				leng=leng+json.scoreboard[i].games.length;
				for(j=0;j<json.scoreboard[i].games.length;j++){
					games.push(json.scoreboard[i].games[j]);
				}
			}
			makehtml(games)
			
		}
		
		function updatedata(json) {
			var games=[];
			for(var i=0;i<json.scoreboard.length;i++){
				leng=leng+json.scoreboard[i].games.length;
				for(j=0;j<json.scoreboard[i].games.length;j++){
					games.push(json.scoreboard[i].games[j]);
				}
			}
			updatehtml(games)
			
		}

		
		
		function make(){
			$.ajax({
				url: "http://data.ncaa.com/jsonp/scoreboard/football/fbs/2017/02/scoreboard.html?callback=makedata",
				dataType: "jsonp"
			})
		}
		
		function update(){
			$.ajax({
				url: "http://data.ncaa.com/jsonp/scoreboard/football/fbs/2017/02/scoreboard.html?callback=updatedata",
				dataType: "jsonp"
			})
		}
		
		
		
		
		
		function makehtml(data) {
				$('body').html('')
				for(i=0;i<data.length;i++){
					//if(data[i].conference.includes('big-12')==false&&data[i].conference.includes('top-25')==false){continue;}
					if (data[i].gameState=='cancelled'||data[i].gameState=='canceled'){continue;}
					var hrank = '';
					var arank = '';
					if (data[i].home.teamRank >0){hrank='('+data[i].home.teamRank+') '}
					if (data[i].away.teamRank >0){arank='('+data[i].away.teamRank+') '}
					$('body').append('<div class="floatingbox"><div class="split1"><p class="'+data[i].id+'-time">'+moment.unix(data[i].startTimeEpoch).fromNow()+'</p><div class="'+data[i].id+'-homename">'+hrank+data[i].home.nameRaw+'</div><div class="'+data[i].id+'-awayname">'+arank+data[i].away.nameRaw+'</div></div><div class="split2"><p class="'+data[i].id+'-period">'+data[i].gameState+'</p><div class="'+data[i].id+'-home">'+data[i].home.currentScore+'</div><div class="'+data[i].id+'-away">'+data[i].away.currentScore+'</div></div></div>')
				}
		}
		
		function updatehtml(data) {
				for(k=0;k<data.length;k++){
					if(data[k].gameState=='pre'){//||data[k].gameState=='final'){
						$("."+data[k].id+"-time").html(moment.unix(data[k].startTimeEpoch).fromNow());
					}
					if(data[k].gameState=='live'){
						var down = data[k].status.down;
						if (down == 1){down=down+'st'}
						if (down == 2){down=down+'nd'}
						if (down == 3){down=down+'rd'}
						if (down == 4){down=down+'th'}
						$("."+data[k].id+"-time").html(down+" and "+data[k].status.distance+" yards "+data[k].timeclock)
						$("."+data[k].id+"-period").html(data[k].currentPeriod)
						if(data[k].status.possession==data[k].home.nameRaw){
							if($("."+data[k].id+"-homename")["0"].classList[1]!="ion-ios-americanfootball"){
								console.log('toggling possession to home team')
								$("."+data[k].id+"-homename").toggleClass("ion-ios-americanfootball")
							}
							if($("."+data[k].id+"-awayname")["0"].classList[1]=="ion-ios-americanfootball"){
								console.log('toggling possession from away team')
								$("."+data[k].id+"-awayname").toggleClass("ion-ios-americanfootball")
							}
						}
						if(data[k].status.possession==data[k].away.nameRaw){
							if($("."+data[k].id+"-awayname")["0"].classList[1]!="ion-ios-americanfootball"){
								console.log('toggling possession to away team')
								$("."+data[k].id+"-awayname").toggleClass("ion-ios-americanfootball")
							}
							if($("."+data[k].id+"-homename")["0"].classList[1]=="ion-ios-americanfootball"){
								console.log('toggling possesion from home team')
								$("."+data[k].id+"-homename").toggleClass("ion-ios-americanfootball")
							}
						}
					}
					if(data[k].gameState=='final'){
						$("."+data[k].id+"-period").html(data[k].gameState)
						$("."+data[k].id+"-homename").removeClass("ion-ios-americanfootball")
						$("."+data[k].id+"-awayname").removeClass("ion-ios-americanfootball")
						if(data[k].home.winner=="true"){
							if($("."+data[k].id+"-homename").hasClass("ion-trophy")==false){
								$("."+data[k].id+"-homename").toggleClass("ion-trophy")
								$("."+data[k].id+"-time").html(data[k].home.nameRaw+" Won")
							}
						}
						if(data[k].away.winner=="true"){
							if($("."+data[k].id+"-awayname").hasClass("ion-trophy")==false){
								$("."+data[k].id+"-awayname").toggleClass("ion-trophy")
								$("."+data[k].id+"-time").html(data[k].away.nameRaw+" Won")
							}
						}
					}
					$("."+data[k].id+"-home").html(data[k].home.currentScore);
					$("."+data[k].id+"-away").html(data[k].away.currentScore);
				}
		}
		setInterval(function(){
			update()
		}, 15000);
	</script>
	
</head>

<body onload='make()'>

</body>
